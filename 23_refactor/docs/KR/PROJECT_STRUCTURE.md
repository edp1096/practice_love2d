# í”„ë¡œì íŠ¸ êµ¬ì¡°

## ğŸ“ ë£¨íŠ¸ ë””ë ‰í† ë¦¬

```
23_refactor/
â”œâ”€â”€ main.lua              - ì§„ì…ì  (LÃ–VE ì½œë°±, ì—ëŸ¬ í•¸ë“¤ëŸ¬, ì…ë ¥ ë¼ìš°íŒ…)
â”œâ”€â”€ conf.lua              - LÃ–VE ì„¤ì • (ìœˆë„ìš°, ëª¨ë“ˆ, ë²„ì „)
â”œâ”€â”€ locker.lua            - í”„ë¡œì„¸ìŠ¤ ì ê¸ˆ (ë°ìŠ¤í¬í†± ì „ìš©, ë‹¤ì¤‘ ì¸ìŠ¤í„´ìŠ¤ ë°©ì§€)
â”œâ”€â”€ config.ini            - ì‚¬ìš©ì ì„¤ì • (ìœˆë„ìš°, ì‚¬ìš´ë“œ, ì…ë ¥, IsDebug)
â”‚
â”œâ”€â”€ engine/               - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê²Œì„ ì—”ì§„ (100% ì¬ì‚¬ìš© ê°€ëŠ¥ - ëª¨ë“  ì—”í‹°í‹° í¬í•¨!)
â”œâ”€â”€ game/                 - ê²Œì„ ì „ìš© ì½˜í…ì¸  (ë°ì´í„° ì„¤ì • + ìµœì†Œ ì½”ë“œ)
â”œâ”€â”€ vendor/               - ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ (STI, Windfield, anim8, hump, Talkies)
â”œâ”€â”€ assets/               - ê²Œì„ ë¦¬ì†ŒìŠ¤ (ë§µ, ì´ë¯¸ì§€, ì‚¬ìš´ë“œ, í°íŠ¸)
â””â”€â”€ docs/                 - ë¬¸ì„œ (ì´ í´ë”)
```

---

## ğŸ® ì—”ì§„ í´ë” (`engine/`)

**ëª©ì :** 100% ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê²Œì„ ì—”ì§„ (ê³„ì¸µ ì•„í‚¤í…ì²˜).

**ì•„í‚¤í…ì²˜:** ëª…í™•í•œ ê³„ì¸µìœ¼ë¡œ êµ¬ì„±:
- **core/** - í•µì‹¬ ì‹œìŠ¤í…œ (lifecycle, input, display, sound, save ë“±)
- **systems/** - ì„œë¸Œì‹œìŠ¤í…œ (world, effects, lighting, hud)
- **scenes/** - ì”¬ ë¹Œë” ë° í…œí”Œë¦¿
- **entities/** - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì—”í‹°í‹° (player, enemy, weapon, npc, item) â­
- **ui/** - UI ì‹œìŠ¤í…œ (menu, screens, dialogue, widgets)
- **utils/** - ìœ í‹¸ë¦¬í‹° (text, fonts, util, ini)

```
engine/
â”œâ”€â”€ core/                 - **í•µì‹¬ ì—”ì§„ ì‹œìŠ¤í…œ (Layer 1)**
â”‚   â”œâ”€â”€ lifecycle.lua     - ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒëª…ì£¼ê¸°
â”‚   â”œâ”€â”€ scene_control.lua - ì”¬ ìŠ¤íƒ ê´€ë¦¬
â”‚   â”œâ”€â”€ camera.lua        - ì¹´ë©”ë¼ íš¨ê³¼
â”‚   â”œâ”€â”€ coords.lua        - **í†µí•© ì¢Œí‘œê³„ ì‹œìŠ¤í…œ**
â”‚   â”œâ”€â”€ sound.lua         - ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ save.lua          - ì €ì¥/ë¡œë“œ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ inventory.lua     - ì¸ë²¤í† ë¦¬ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ debug.lua         - ë””ë²„ê·¸ ì˜¤ë²„ë ˆì´
â”‚   â”œâ”€â”€ constants.lua     - ì—”ì§„ ìƒìˆ˜
â”‚   â”œâ”€â”€ display/          - ê°€ìƒ í™”ë©´ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ input/            - ì…ë ¥ ì‹œìŠ¤í…œ
â”‚       â”œâ”€â”€ dispatcher.lua              - ì…ë ¥ ì´ë²¤íŠ¸ ë””ìŠ¤íŒ¨ì²˜
â”‚       â”œâ”€â”€ sources/                    - ì¿¼ë¦¬ ê¸°ë°˜ ì…ë ¥ ì†ŒìŠ¤ (í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤, ê²Œì„íŒ¨ë“œ)
â”‚       â””â”€â”€ virtual_gamepad/            - ì´ë²¤íŠ¸ ê¸°ë°˜ ì…ë ¥ (ëª¨ë°”ì¼ í„°ì¹˜)
â”‚           â”œâ”€â”€ init.lua                - ë©”ì¸ ì½”ë””ë„¤ì´í„°
â”‚           â”œâ”€â”€ renderer.lua            - ë Œë”ë§ í•¨ìˆ˜
â”‚           â””â”€â”€ touch.lua               - í„°ì¹˜ ì´ë²¤íŠ¸ í•¸ë“¤ë§
â”‚
â”œâ”€â”€ systems/              - **ì—”ì§„ ì„œë¸Œì‹œìŠ¤í…œ (Layer 2)**
â”‚   â”œâ”€â”€ collision.lua     - **ì¶©ëŒ ì‹œìŠ¤í…œ** (ì´ì¤‘ ì½œë¼ì´ë”, Y-ì •ë ¬)
â”‚   â”œâ”€â”€ world/            - ë¬¼ë¦¬ & ì›”ë“œ ì‹œìŠ¤í…œ (Windfield/STI)
â”‚   â”‚   â”œâ”€â”€ init.lua      - ì›”ë“œ ì½”ë””ë„¤ì´í„°, ì¶©ëŒ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ loaders.lua   - ë§µ ë¡œë”© (Tiled TMX + Trees íƒ€ì¼)
â”‚   â”‚   â”œâ”€â”€ entities.lua  - ì—”í‹°í‹° ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ rendering.lua - Y-ì •ë ¬ ë Œë”ë§ (ì—”í‹°í‹° + Trees íƒ€ì¼)
â”‚   â”œâ”€â”€ effects/          - ì‹œê° íš¨ê³¼ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ lighting/         - ë¼ì´íŒ… ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ hud/              - ì¸ê²Œì„ HUD ì‹œìŠ¤í…œ
â”‚
â”œâ”€â”€ scenes/               - **ì”¬ ê´€ë¦¬ (Layer 3)**
â”‚   â”œâ”€â”€ builder.lua       - **ë°ì´í„° ê¸°ë°˜ ì”¬ íŒ©í† ë¦¬**
â”‚   â”œâ”€â”€ cutscene.lua      - ì»·ì‹ /ì¸íŠ¸ë¡œ ì”¬
â”‚   â””â”€â”€ gameplay.lua      - ë©”ì¸ ê²Œì„í”Œë ˆì´ ì”¬
â”‚
â”œâ”€â”€ entities/             - **ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì—”í‹°í‹° (Layer 3)** â­ ëª¨ë‘ ì—”ì§„ì—!
â”‚   â”œâ”€â”€ factory.lua       - **ì—”í‹°í‹° íŒ©í† ë¦¬** (Tiled ì†ì„±ìœ¼ë¡œë¶€í„° ìƒì„±)
â”‚   â”œâ”€â”€ player/           - í”Œë ˆì´ì–´ ì—”í‹°í‹° (ì˜ì¡´ì„± ì£¼ì…)
â”‚   â”œâ”€â”€ enemy/            - ì  ì—”í‹°í‹° (íƒ€ì… ì£¼ì…)
â”‚   â”œâ”€â”€ weapon/           - ë¬´ê¸° ì—”í‹°í‹° (ì„¤ì • ì£¼ì…)
â”‚   â”œâ”€â”€ npc/              - NPC ì—”í‹°í‹°
â”‚   â”œâ”€â”€ item/             - ì•„ì´í…œ ì—”í‹°í‹°
â”‚   â””â”€â”€ healing_point/    - íšŒë³µ í¬ì¸íŠ¸ ì—”í‹°í‹°
â”‚
â”œâ”€â”€ ui/                   - **UI ì‹œìŠ¤í…œ (Layer 4)**
â”‚   â”œâ”€â”€ menu/             - ë©”ë‰´ UI ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ screens/          - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI í™”ë©´ë“¤
â”‚   â”œâ”€â”€ dialogue.lua      - NPC ëŒ€í™” ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ shapes.lua        - ë„í˜• ë Œë”ë§ ìœ í‹¸ë¦¬í‹°
â”‚   â””â”€â”€ widgets/          - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ìœ„ì ¯ë“¤
â”‚
â””â”€â”€ utils/                - **ì—”ì§„ ìœ í‹¸ë¦¬í‹° (Layer 0)**
    â”œâ”€â”€ util.lua          - ì¼ë°˜ ìœ í‹¸ë¦¬í‹°
    â”œâ”€â”€ text.lua          - **í…ìŠ¤íŠ¸ ë Œë”ë§ ìœ í‹¸ë¦¬í‹°**
    â”œâ”€â”€ fonts.lua         - í°íŠ¸ ê´€ë¦¬
    â”œâ”€â”€ restart.lua       - ê²Œì„ ì¬ì‹œì‘ ë¡œì§
    â”œâ”€â”€ convert.lua       - ë°ì´í„° ë³€í™˜ í—¬í¼
    â””â”€â”€ ini.lua           - INI íŒŒì¼ íŒŒì„œ
```

**ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´:**
```lua
-- main.luaê°€ ê²Œì„ ì„¤ì •ì„ ì—”ì§„ í´ë˜ìŠ¤ì— ì£¼ì…
local player_module = require "engine.entities.player"
local player_config = require "game.data.player"
player_module.config = player_config  -- ê²Œì„ë³„ ì„¤ì • ì£¼ì…!
```

---

## ğŸ•¹ï¸ ê²Œì„ í´ë” (`game/`)

**ëª©ì :** ê²Œì„ ì „ìš© ì½˜í…ì¸  (ë°ì´í„° ì¤‘ì‹¬ ê²Œì„ ê°œë°œ).

```
game/
â”œâ”€â”€ scenes/               - ê²Œì„ í™”ë©´ (ë©”ë‰´, ê²Œì„í”Œë ˆì´)
â”‚   â”œâ”€â”€ menu.lua
â”‚   â”œâ”€â”€ gameover.lua
â”‚   â”œâ”€â”€ intro.lua
â”‚   â”œâ”€â”€ pause.lua
â”‚   â”œâ”€â”€ newgame.lua
â”‚   â”œâ”€â”€ saveslot.lua
â”‚   â”œâ”€â”€ play/             - ë©”ì¸ ê²Œì„í”Œë ˆì´ ì”¬ (ëª¨ë“ˆí˜•)
â”‚   â”‚   â”œâ”€â”€ init.lua      - ì”¬ ì½”ë””ë„¤ì´í„°
â”‚   â”‚   â”œâ”€â”€ update.lua    - ê²Œì„ ë£¨í”„
â”‚   â”‚   â”œâ”€â”€ render.lua    - ê·¸ë¦¬ê¸°
â”‚   â”‚   â””â”€â”€ input.lua     - ì…ë ¥ ì²˜ë¦¬
â”‚   â”œâ”€â”€ settings/         - ì„¤ì • ë©”ë‰´ (ëª¨ë“ˆí˜•)
â”‚   â”‚   â”œâ”€â”€ init.lua
â”‚   â”‚   â”œâ”€â”€ options.lua
â”‚   â”‚   â”œâ”€â”€ render.lua
â”‚   â”‚   â””â”€â”€ input.lua
â”‚   â”œâ”€â”€ load/             - ê²Œì„ ë¡œë“œ ì”¬ (ëª¨ë“ˆí˜•)
â”‚   â”‚   â”œâ”€â”€ init.lua
â”‚   â”‚   â”œâ”€â”€ slot_renderer.lua
â”‚   â”‚   â””â”€â”€ input.lua
â”‚   â””â”€â”€ inventory/        - ì¸ë²¤í† ë¦¬ ì˜¤ë²„ë ˆì´ (ëª¨ë“ˆí˜•)
â”‚       â”œâ”€â”€ init.lua
â”‚       â”œâ”€â”€ slot_renderer.lua
â”‚       â””â”€â”€ input.lua
â”‚
â”œâ”€â”€ entities/             - ê²Œì„ ìºë¦­í„° & ì˜¤ë¸Œì íŠ¸
â”‚   â”œâ”€â”€ player/
â”‚   â”‚   â”œâ”€â”€ init.lua      - ë©”ì¸ ì½”ë””ë„¤ì´í„°
â”‚   â”‚   â”œâ”€â”€ animation.lua - ì• ë‹ˆë©”ì´ì…˜ ìƒíƒœ ë¨¸ì‹ 
â”‚   â”‚   â”œâ”€â”€ combat.lua    - ì²´ë ¥, ê³µê²©, íŒ¨ë¦¬, íšŒí”¼
â”‚   â”‚   â”œâ”€â”€ render.lua    - ê·¸ë¦¬ê¸° ë¡œì§
â”‚   â”‚   â””â”€â”€ sound.lua     - í”Œë ˆì´ì–´ ì‚¬ìš´ë“œ íš¨ê³¼
â”‚   â”œâ”€â”€ enemy/
â”‚   â”‚   â”œâ”€â”€ init.lua
â”‚   â”‚   â”œâ”€â”€ ai.lua        - AI ìƒíƒœ ë¨¸ì‹ 
â”‚   â”‚   â”œâ”€â”€ render.lua
â”‚   â”‚   â”œâ”€â”€ sound.lua
â”‚   â”‚   â”œâ”€â”€ spawner.lua   - ì  ìƒì„± ë¡œì§
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â”œâ”€â”€ slime.lua
â”‚   â”‚       â””â”€â”€ humanoid.lua
â”‚   â”œâ”€â”€ weapon/
â”‚   â”‚   â”œâ”€â”€ init.lua
â”‚   â”‚   â”œâ”€â”€ combat.lua
â”‚   â”‚   â”œâ”€â”€ render.lua
â”‚   â”‚   â”œâ”€â”€ config/       - ë¬´ê¸° ì„¤ì •
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â””â”€â”€ sword.lua
â”‚   â”œâ”€â”€ npc/
â”‚   â”‚   â”œâ”€â”€ init.lua
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â””â”€â”€ villager.lua
â”‚   â”œâ”€â”€ item/
â”‚   â”‚   â”œâ”€â”€ init.lua
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â”œâ”€â”€ small_potion.lua
â”‚   â”‚       â””â”€â”€ large_potion.lua
â”‚   â””â”€â”€ healing_point.lua - íë§ í¬ì¸íŠ¸ ì—”í‹°í‹° (ë‹¨ì¼ íŒŒì¼)
â”‚
â””â”€â”€ data/                 - ê²Œì„ ì„¤ì • ë°ì´í„°
    â”œâ”€â”€ input_config.lua  - í‚¤ ë§¤í•‘ & ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì •
    â”œâ”€â”€ sounds.lua        - ì‚¬ìš´ë“œ ì—ì…‹ ì •ì˜ (BGM, SFX)
    â””â”€â”€ intro_configs.lua - ì¸íŠ¸ë¡œ/ì»·ì‹  ì„¤ì •
```

---

## ğŸ”§ ë²¤ë” í´ë” (`vendor/`)

**ëª©ì :** ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ìˆ˜ì •ë˜ì§€ ì•ŠìŒ).

```
vendor/
â”œâ”€â”€ anim8/                - ìŠ¤í”„ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
â”œâ”€â”€ hump/                 - ìœ í‹¸ë¦¬í‹° ì»¬ë ‰ì…˜ (ì¹´ë©”ë¼, íƒ€ì´ë¨¸, ë²¡í„°)
â”œâ”€â”€ sti/                  - Simple Tiled Implementation (TMX ë¡œë”)
â”œâ”€â”€ windfield/            - Box2D ë¬¼ë¦¬ ë˜í¼
â””â”€â”€ talkies/              - ëŒ€í™”/í…ìŠ¤íŠ¸ ë°•ìŠ¤ ì‹œìŠ¤í…œ
```

---

## ğŸ¨ ì—ì…‹ í´ë” (`assets/`)

**ëª©ì :** ê²Œì„ ë¦¬ì†ŒìŠ¤.

```
assets/
â”œâ”€â”€ maps/                 - Tiled ë§µ (.tmx + .lua)
â”‚   â”œâ”€â”€ level1/
â”‚   â”‚   â”œâ”€â”€ area1.lua/tmx
â”‚   â”‚   â”œâ”€â”€ area2.lua/tmx
â”‚   â”‚   â””â”€â”€ area3.lua/tmx
â”‚   â””â”€â”€ level2/
â”‚       â””â”€â”€ area1.lua/tmx
â”œâ”€â”€ images/               - ìŠ¤í”„ë¼ì´íŠ¸, íƒ€ì¼ì…‹, UI ê·¸ë˜í”½
â”œâ”€â”€ bgm/                  - ë°°ê²½ ìŒì•… (.ogg, .mp3)
â”œâ”€â”€ sound/                - ì‚¬ìš´ë“œ íš¨ê³¼ (.wav)
â””â”€â”€ fonts/                - ì»¤ìŠ¤í…€ í°íŠ¸
```

---

## ğŸ“Š íŒŒì¼ ê°œìˆ˜ ìš”ì•½

| ì¹´í…Œê³ ë¦¬ | íŒŒì¼ ìˆ˜ | ë¼ì¸ ìˆ˜ |
|----------|-------|-------|
| **Engine** | ~30 íŒŒì¼ | ~4,500 ë¼ì¸ |
| **Game Content** | ~50 íŒŒì¼ | ~7,000 ë¼ì¸ |
| **Total** | ~80 íŒŒì¼ | ~11,500 ë¼ì¸ |

---

## ğŸ¯ ì„¤ê³„ ì›ì¹™

### 1. Engine/Game ë¶„ë¦¬
- **Engine:** "ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ê°€?" (ì‹œìŠ¤í…œ, ë©”ì»¤ë‹ˆì¦˜)
- **Game:** "ë¬´ì—‡ì„ ë³´ì—¬ì£¼ëŠ”ê°€?" (ì½˜í…ì¸ , ë°ì´í„°)

### 2. ëª¨ë“ˆí˜• ì•„í‚¤í…ì²˜
- ë³µì¡í•œ ì‹œìŠ¤í…œì„ ì§‘ì¤‘ëœ íŒŒì¼ë¡œ ë¶„í• 
- ëª¨ë“ˆë‹¹ ë‹¨ì¼ ì±…ì„
- ì°¾ê³  ìˆ˜ì •í•˜ê¸° ì‰¬ì›€

### 3. ì½˜í…ì¸  ì¤‘ì‹¬ ì² í•™
- ì—”ì§„ì€ í”„ë¡œì íŠ¸ ê°„ ì¬ì‚¬ìš© ê°€ëŠ¥
- game í´ë”ëŠ” ì½˜í…ì¸  ì „ìš©
- game/ì— ìµœì†Œí•œì˜ ì½”ë“œ (ì£¼ë¡œ ë°ì´í„°)

---

**ì°¸ê³ :**
- [ENGINE_GUIDE.md](ENGINE_GUIDE.md) - ì—”ì§„ ì‹œìŠ¤í…œ ë ˆí¼ëŸ°ìŠ¤
- [GAME_GUIDE.md](GAME_GUIDE.md) - ì½˜í…ì¸  ì œì‘ ê°€ì´ë“œ
